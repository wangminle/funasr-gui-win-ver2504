# FunASR Python GUI Client V2 文件上传限制分析文档

**最后更新日期:** 2024-07-27

## 1. 限制的来源

您提到的1GB文件上传限制**不是FunASR服务器设置的**，而是**客户端WebSocket连接配置中设定的**。

在项目代码中（`dev/src/python-gui-client/simple_funasr_client.py` 第403-410行），我发现了这个限制：

```python
# 设置更大的max_size参数以支持更大的消息
# 默认是1MB，这里设置为1GB
async with websockets.connect(
    uri, 
    subprotocols=["binary"], 
    ping_interval=None, 
    ssl=ssl_context,
    close_timeout=60,
    max_size=1024 * 1024 * 1024  # 1GB的最大消息大小
) as websocket:
```

## 2. 技术背景

1.  **WebSocket默认限制**: Python的`websockets`库默认将单个消息的最大大小限制为1MB。
2.  **项目优化**: 开发者将这个限制提升到了1GB，以支持更大的音频/视频文件。
3.  **实际需求**: 这个1GB限制已经覆盖了大部分实际使用场景。

## 3. 超过1GB文件的可行性

根据我的分析，**理论上可以上传超过1GB的视频文件**，但需要进行以下修改：

### 方案1：直接修改max_size参数
```python
# 将1GB限制改为更大的值，比如10GB
max_size=10 * 1024 * 1024 * 1024  # 10GB的最大消息大小
```

### 方案2：完全移除限制
```python
# 设置为None移除大小限制
max_size=None
```

## 4. 需要考虑的因素

1.  **内存消耗**: 超大文件会占用大量内存。
2.  **网络稳定性**: 长时间传输容易受网络波动影响。
3.  **服务器处理能力**: FunASR服务器需要有足够资源处理大文件。
4.  **超时设置**: 需要相应调整连接和处理超时时间。

## 5. 实际测试数据

从项目的性能文档(`docs/FunASR-performance.md`)中可以看到：
-   项目已成功处理过412.56MB的大文件。
-   1GB限制是为了平衡性能和功能需求而设定的。

## 6. 总结与建议

**总结**: 1GB限制是客户端为性能考虑设定的，而非FunASR服务器的强制要求。通过修改客户端代码，理论上可以支持更大的文件，但需要综合考虑系统资源和稳定性。

**建议**:
1.  **先测试**: 在小范围内测试修改后的代码。
2.  **分步提升**: 先试试2GB、5GB，确认系统稳定性。
3.  **监控资源**: 注意内存和网络使用情况。
4.  **备用方案**: 考虑预处理将大文件分段处理。 